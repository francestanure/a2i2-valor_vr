<button id="gerar">Gerar planilha</button>
<script>
const WEBHOOK_URL = "https://n8n-service-to7f.onrender.com:5678/webhook/start";
const API_KEY = "SEU_TOKEN_SEGURO"; // o mesmo do Webhook (Header Auth)

// Exemplo de payload que seu fluxo já entende:
const payload = {
  params: { turma: "A", mes: "2025-08" },
  // ... o que quiser passar
};

document.getElementById('gerar').addEventListener('click', async () => {
  const res = await fetch(WEBHOOK_URL, {
    method: 'POST',
    mode: 'cors',
    headers: {
      'Content-Type': 'application/json',
      'x-api-key': API_KEY
    },
    body: JSON.stringify(payload)
  });
  // No final do fluxo você retornará HTML. Você pode abrir em nova aba:
  const html = await res.text();
  const blob = new Blob([html], { type: 'text/html' });
  window.open(URL.createObjectURL(blob), '_blank');
});
</script>
